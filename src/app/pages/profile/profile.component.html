<app-header></app-header>

<div class="container mt-5">
  <div style="height: 45rem" class="p-5 shadow-lg">
    <div *ngIf="!isLoad">
      <div class="row">
        <div class="col-4 d-flex justify-content-center">
          <div style="width: 200px; height: 200px">
            <img
              style="object-fit: cover; object-position: center"
              class="w-100 h-100 rounded-circle"
              [src]="user.AvatarURL"
              alt=""
            />
          </div>
        </div>
        <div class="col-8">
          <span class="fw-bold fs-2">{{ user.display_name }}</span>
          <br />
          <button
            style="width: 9rem"
            routerLink="/edit_profile"
            class="mt-2"
            mat-stroked-button
          >
            EditProfile</button
          ><br />
          <label for="avatarUpload" class="mt-2 button-label">
            <div style="width: 9rem" class="button-container text-center">
              <span>Change Avatar</span>
              <input
                type="file"
                id="avatarUpload"
                (change)="changeAvatar($event)"
                style="display: none"
              />
            </div>
          </label>
        </div>
      </div>
      <hr class="my-5" />
      <div class="row row-cols-2 row-cols-lg-5 g-2 g-lg-3 text-center">
        <div *ngFor="let item of userImg; let i = index" class="col">
          <div>
            <div *ngIf="item; else elseBlock">
              <div
                style="height: 18rem; position: relative"
                class="w-100 border border-2 border-black"
                (mouseenter)="toggleHoverState(i)"
                (mouseleave)="toggleHoverState(i)"
              >
                <img
                  style="object-fit: cover; object-position: center"
                  class="w-100 h-100"
                  [src]="item.ImageURL"
                  alt=""
                  [ngClass]="{ 'blur-image': hoverStates[i] }"
                />
                <button
                  *ngIf="hoverStates[i]"
                  mat-raised-button
                  style="top: 40%"
                  class="position-absolute start-50 translate-middle w-75"
                >
                  <label
                    for="fileInput"
                    style="cursor: pointer"
                    class="d-flex flex-column align-items-center"
                  >
                    <div class="d-flex align-items-center">
                      <mat-icon
                        class="fs-5 h-100"
                        aria-hidden="false"
                        fontIcon="change_circle"
                      ></mat-icon>
                      <span>Change Image</span>
                    </div>

                    <input
                      type="file"
                      id="fileInput"
                      (change)="changeImg($event)"
                      style="display: none"
                    />
                  </label>
                </button>
                <button
                  *ngIf="hoverStates[i]"
                  mat-raised-button
                  color="warn"
                  style="top: 55%"
                  class="position-absolute start-50 translate-middle w-75"
                  (click)="deleteImg(item.ImageID)"
                >
                  <mat-icon
                    class="fs-5"
                    aria-hidden="false"
                    fontIcon="delete"
                  ></mat-icon>
                  Delete Image
                </button>
              </div>
              <div
                class="d-flex align-items-center justify-content-center mt-2"
              >
                <mat-icon
                  aria-hidden="false"
                  fontIcon="favorite"
                  color="accent"
                ></mat-icon>
                <span class="fw-semibold">{{ item.EloScore }}</span>
              </div>
            </div>
            <ng-template #elseBlock>
              <div
                style="height: 18rem"
                class="w-100 border border-2 border-black d-flex justify-content-center align-items-center"
              >
                <input
                  type="file"
                  (change)="uploadImg($event)"
                  style="display: none"
                  #fileInput
                />
                <div
                  (click)="fileInput.click()"
                  style="height: 50px; width: 50px; cursor: pointer"
                  class="d-flex justify-content-center align-items-center border border-black rounded-circle"
                >
                  <mat-icon fontIcon="add"></mat-icon>
                </div>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
    <div
      *ngIf="isLoad"
      class="d-flex justify-content-center align-items-center h-100"
    >
      <img
        src="https://i.pinimg.com/originals/13/90/75/13907559a21dd41293af7c57a89b3849.gif"
        alt=""
      />
    </div>
  </div>
</div>
